<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Meta tags  -->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">

  <title>Edit Profile</title>
    <link rel="icon" type="image/png" href="../img/about-img.png">

  <!-- CSS Assets -->
  <link rel="stylesheet" href="../assets/css/app.css">

  <!-- Javascript Assets -->
  <script src="../assets/js/app.js" defer=""></script>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
  <link href="css2?family=Inter:wght@400;500;600;700&family=Poppins:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
  <script>
    /**
     * THIS SCRIPT REQUIRED FOR PREVENT FLICKERING IN SOME BROWSERS
     */
    localStorage.getItem("_x_darkMode_on") === "true" &&
    document.documentElement.classList.add("dark");
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Get current user from localStorage
      const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');

      // Only allow admins to stay on the page
      if (!currentUser || !currentUser.id || currentUser.role !== 'manager') {
        // Redirect non-admin users to homepage (or another appropriate page)
        window.location.href = '../all_users/homepage.html';
      }
      // If the user is admin, they stay on the page
    });
  </script>

  <style>
    .pad{
      padding:3rem 4rem 0 4rem;
    }
  </style>
</head>

<body x-data="" class="is-header-blur" x-bind="$store.global.documentBody">
<!-- App preloader-->
<div class="app-preloader fixed z-50 grid h-full w-full place-content-center bg-slate-50 dark:bg-navy-900">
  <div class="app-preloader-inner relative inline-block size-48"></div>
</div>

<!-- Page Wrapper -->
<div id="root" class="min-h-100vh flex grow bg-slate-50 dark:bg-navy-900" x-cloak="">

  <!-- Sidebar -->
  <div class="sidebar print:hidden" x-data="sidebarUser()">
    <!-- Main Sidebar -->
    <div class="main-sidebar">
      <div class="flex h-full w-full flex-col items-center border-r border-slate-150 bg-white dark:border-navy-700 dark:bg-navy-800">

        <!-- Application Logo -->
        <div class="flex pt-4">
          <!-- Profile -->
          <div x-data="usePopper({placement:'right-end',offset:12})" @click.outside="isShowPopper && (isShowPopper = false)" class="flex">
            <button @click="isShowPopper = !isShowPopper" x-ref="popperRef" class="avatar size-12">
              <img class="rounded-full" :src="userAvatar" :alt="userName" onerror="this.src='../images/avatar/avatar-12.jpg'">
              <span class="absolute right-0 size-3.5 rounded-full border-2 border-white bg-success dark:border-navy-700"></span>
            </button>

            <div :class="isShowPopper && 'show'" class="popper-root fixed" x-ref="popperRoot">
              <div class="popper-box w-64 rounded-lg border border-slate-150 bg-white shadow-soft dark:border-navy-600 dark:bg-navy-700">
                <div class="flex items-center space-x-4 rounded-t-lg bg-slate-100 py-5 px-4 dark:bg-navy-800">
                  <div class="avatar size-14">
                    <img class="rounded-full" :src="userAvatar" :alt="userName" onerror="this.src='../images/avatar/avatar-12.jpg'">
                  </div>
                  <div>
                    <a href="#" class="text-base font-medium text-slate-700 hover:text-primary focus:text-primary dark:text-navy-100 dark:hover:text-accent-light dark:focus:text-accent-light" x-text="userName">
                      User Name
                    </a>
                    <p class="text-xs text-slate-400 dark:text-navy-300" x-text="userRole">
                      Role
                    </p>
                  </div>
                </div>
                <div class="flex flex-col pt-2 pb-5">
                  <a href="../all_users/homepage.html" class="group flex items-center space-x-3 py-2 px-4 tracking-wide outline-none transition-all hover:bg-slate-100 focus:bg-slate-100 dark:hover:bg-navy-600 dark:focus:bg-navy-600">
                    <div class="flex size-8 items-center justify-center rounded-lg bg-error text-white">
                      <svg xmlns="http://www.w3.org/2000/svg" class="size-4.5" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                      </svg>
                    </div>
                    <div>
                      <h2 class="font-medium text-slate-700 transition-colors group-hover:text-primary group-focus:text-primary dark:text-navy-100 dark:group-hover:text-accent-light dark:group-focus:text-accent-light">
                        Home Page
                      </h2>
                      <div class="text-xs text-slate-400 line-clamp-1 dark:text-navy-300">
                        Go to home page
                      </div>
                    </div>
                  </a>

                  <div class="mt-3 px-4">
                    <button @click="logout" class="btn h-9 w-full space-x-2 bg-primary text-white hover:bg-primary-focus focus:bg-primary-focus active:bg-primary-focus/90 dark:bg-accent dark:hover:bg-accent-focus dark:focus:bg-accent-focus dark:active:bg-accent/90">
                      <svg xmlns="http://www.w3.org/2000/svg" class="size-5" fill="none" viewbox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                      </svg>
                      <span>Logout</span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Main Sections Links -->
        <div class="is-scrollbar-hidden flex grow flex-col space-y-4 overflow-y-auto pt-6">
          <!-- Dashboards -->
          <a href="manager_dashboard.html" class="flex size-11 items-center justify-center rounded-lg outline-none transition-colors duration-200 hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25" x-tooltip.placement.right="'Dashboards'">
            <svg class="size-7" xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24">
              <path fill="currentColor" fill-opacity=".3" d="M5 14.059c0-1.01 0-1.514.222-1.945.221-.43.632-.724 1.453-1.31l4.163-2.974c.56-.4.842-.601 1.162-.601.32 0 .601.2 1.162.601l4.163 2.974c.821.586 1.232.88 1.453 1.31.222.43.222.935.222 1.945V19c0 .943 0 1.414-.293 1.707C18.414 21 17.943 21 17 21H7c-.943 0-1.414 0-1.707-.293C5 20.414 5 19.943 5 19v-4.94Z"></path>
              <path fill="currentColor" d="M3 12.387c0 .267 0 .4.084.441.084.041.19-.04.4-.204l7.288-5.669c.59-.459.885-.688 1.228-.688.343 0 .638.23 1.228.688l7.288 5.669c.21.163.316.245.4.204.084-.04.084-.174.084-.441v-.409c0-.48 0-.72-.102-.928-.101-.208-.291-.355-.67-.65l-7-5.445c-.59-.459-.885-.688-1.228-.688-.343 0-.638.23-1.228.688l-7 5.445c-.379.295-.569.442-.67.65-.102.208-.102.448-.102.928v.409Z"></path>
              <path fill="currentColor" d="M11.5 15.5h1A1.5 1.5 0 0 1 14 17v3.5h-4V17a1.5 1.5 0 0 1 1.5-1.5Z"></path>
              <path fill="currentColor" d="M17.5 5h-1a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5Z"></path>
            </svg>
          </a>

          <!-- Admin Bookings -->
          <a href="manager_bookings.html" class="flex size-11 items-center justify-center rounded-lg outline-none transition-colors duration-200 hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25" x-tooltip.placement.right="'Manage Bookings'">
            <svg class="size-7" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M9.85714 3H4.14286C3.51167 3 3 3.51167 3 4.14286V9.85714C3 10.4883 3.51167 11 4.14286 11H9.85714C10.4883 11 11 10.4883 11 9.85714V4.14286C11 3.51167 10.4883 3 9.85714 3Z" fill="currentColor"></path>
              <path d="M9.85714 12.8999H4.14286C3.51167 12.8999 3 13.4116 3 14.0428V19.757C3 20.3882 3.51167 20.8999 4.14286 20.8999H9.85714C10.4883 20.8999 11 20.3882 11 19.757V14.0428C11 13.4116 10.4883 12.8999 9.85714 12.8999Z" fill="currentColor" fill-opacity="0.3"></path>
              <path d="M19.757 3H14.0428C13.4116 3 12.8999 3.51167 12.8999 4.14286V9.85714C12.8999 10.4883 13.4116 11 14.0428 11H19.757C20.3882 11 20.8999 10.4883 20.8999 9.85714V4.14286C20.8999 3.51167 20.3882 3 19.757 3Z" fill="currentColor" fill-opacity="0.3"></path>
              <path d="M19.757 12.8999H14.0428C13.4116 12.8999 12.8999 13.4116 12.8999 14.0428V19.757C12.8999 20.3882 13.4116 20.8999 14.0428 20.8999H19.757C20.3882 20.8999 20.8999 20.3882 20.8999 19.757V14.0428C20.8999 13.4116 20.3882 12.8999 19.757 12.8999Z" fill="currentColor" fill-opacity="0.3"></path>
            </svg>
          </a>

          <!-- Forms -->
          <a href="manager_forms.html" class="flex size-11 items-center justify-center rounded-lg outline-none transition-colors duration-200 hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25" x-tooltip.placement.right="'Manage Forms'">
              <svg class="size-7" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
                  <rect x="2" y="10" width="20" height="10" rx="1.5" fill="currentColor" fill-opacity="0.20"/>
                  <rect x="3.5" y="5.5" width="17" height="10" rx="1.5" fill="currentColor" fill-opacity="0.45"/>
                  <rect x="6" y="1" width="12" height="8" rx="1.25" fill="currentColor" fill-opacity="0.95"/>
                  <line x1="8" y1="3.5" x2="16" y2="3.5" stroke="white" stroke-width="1" stroke-linecap="round" opacity="0.95"/>
                  <line x1="8" y1="5.5" x2="14" y2="5.5" stroke="white" stroke-width="1" stroke-linecap="round" opacity="0.95"/>
              </svg>
          </a>

          <!-- Chat -->
          <a href="manager_chat.html" class="flex size-11 items-center justify-center rounded-lg outline-none transition-colors duration-200 hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25" x-tooltip.placement.right="'Chat'">
            <svg xmlns="http://www.w3.org/2000/svg" class="size-7" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M8 10h.01M12 10h.01M16 10h.01M21 12c0 4.418-4.03 8-9 8a9.009 9.009 0 01-5-1.563l-4.223.885.898-4.21A8.962 8.962 0 013 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
            </svg>
          </a>

          <!-- Users -->
          <a href="manager_manage_users.html" class="flex size-11 items-center justify-center rounded-lg outline-none transition-colors duration-200 hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25" x-tooltip.placement.right="'Manage Users'">
            <!-- UPDATED ICON: Users / Manage Users (only the SVG changed) -->
            <svg xmlns="http://www.w3.org/2000/svg" class="size-7" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <!-- Two person heads -->
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 11a4 4 0 100-8 4 4 0 000 8zM17 13a3 3 0 100-6 3 3 0 000 6z"/>
              <!-- Primary user body -->
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 20.25a6.75 6.75 0 0113.5 0V21a.75.75 0 01-.75.75H3.75A.75.75 0 013 21v-.75z"/>
              <!-- Secondary user body (smaller, to the right) -->
              <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 21.75a.75.75 0 01-.75-.75v-.75a7.46 7.46 0 01.6-2.97 5.25 5.25 0 015.4 0A7.46 7.46 0 0122.5 20.25v.75a.75.75 0 01-.75.75h-5.25z"/>
            </svg>
          </a>

          <!-- staff -->
          <a href="manager_manage_staff.html" class="flex size-11 items-center justify-center rounded-lg outline-none transition-colors duration-200 hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25" x-tooltip.placement.right="'Manage Staff'">
            <!-- UPDATED ICON (different users-style icon) -->
            <svg xmlns="http://www.w3.org/2000/svg" class="size-7" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <!-- Center user -->
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M12 12.5c2.071 0 3.75-1.679 3.75-3.75S14.071 5 12 5s-3.75 1.679-3.75 3.75S9.929 12.5 12 12.5z"/>
              <!-- Left user (behind) -->
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M6.25 11.25A3 3 0 106.26 5.5"/>
              <!-- Right user (behind) -->
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M17.75 11.25A3 3 0 1017.74 5.5"/>
              <!-- Center body -->
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M6.75 18.5c0-2.9 2.66-5.25 5.25-5.25s5.25 2.35 5.25 5.25v.75a.75.75 0 01-.75.75H7.5a.75.75 0 01-.75-.75v-.75z"/>
              <!-- Side bodies (outline suggestion of group) -->
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M3.5 19c0-2.1 1.44-3.95 3.17-4.57M20.5 19c0-2.1-1.44-3.95-3.17-4.57"/>
            </svg>
          </a>

          <!-- Cars -->
          <a href="manager_manage_cars.html"
             class="flex size-11 items-center justify-center rounded-lg outline-none transition-colors duration-200 hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25"
             x-tooltip.placement.right="'Manage Cars'">
            <!-- Replaced icon with a car icon (only change) -->
            <svg xmlns="http://www.w3.org/2000/svg"
                 class="size-7"
                 fill="none"
                 viewBox="0 0 24 24"
                 stroke="currentColor"
                 stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M3 13h18l-1.5-4.5a2 2 0 0 0-1.9-1.4H6.4a2 2 0 0 0-1.9 1.4L3 13Z"/>
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M3 13v5a1 1 0 0 0 1 1h1.2a2 2 0 0 0 3.6 0h6.4a2 2 0 0 0 3.6 0H20a1 1 0 0 0 1-1v-5"/>
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M6 13l1-3h10l1 3"/>
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M7.5 18h.01M16.5 18h.01"/>
            </svg>
          </a>
        </div>

        <!-- Bottom Links -->
        <div class="flex flex-col items-center space-y-3 py-3">
          <!-- Settings - Active Page -->
          <a href="manager_edit_profile.html" class="flex size-11 items-center justify-center rounded-lg bg-primary/10 text-primary outline-none transition-colors duration-200 hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25 dark:bg-navy-600 dark:text-accent-light dark:hover:bg-navy-450 dark:focus:bg-navy-450 dark:active:bg-navy-450/90">
            <svg class="size-7" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-opacity="0.3" fill="currentColor" d="M2 12.947v-1.771c0-1.047.85-1.913 1.899-1.913 1.81 0 2.549-1.288 1.64-2.868a1.919 1.919 0 0 1 .699-2.607l1.729-.996c.79-.474 1.81-.192 2.279.603l.11.192c.9 1.58 2.379 1.58 3.288 0l.11-.192c.47-.795 1.49-1.077 2.279-.603l1.73.996a1.92 1.92 0 0 1 .699 2.607c-.91 1.58-.17 2.868 1.639 2.868 1.04 0 1.899.856 1.899 1.912v1.772c0 1.047-.85 1.912-1.9 1.912-1.808 0-2.548 1.288-1.638 2.869.52.915.21 2.083-.7 2.606l-1.729.997c-.79.473-1.81.191-2.279-.604l-.11-.191c-.9-1.58-2.379-1.58-3.288 0l-.11.19c-.47.796-1.49 1.078-2.279.605l-1.73-.997a1.919 1.919 0 0 1-.699-2.606c.91-1.58.17-2.869-1.639-2.869A1.911 1.911 0 0 1 2 12.947Z"></path>
              <path fill="currentColor" d="M11.995 15.332c1.794 0 3.248-1.464 3.248-3.27 0-1.807-1.454-3.272-3.248-3.272-1.794 0-3.248 1.465-3.248 3.271 0 1.807 1.454 3.271 3.248 3.271Z"></path>
            </svg>
          </a>
        </div>
      </div>
    </div>

    <!-- Sidebar Panel -->
    <div class="sidebar-panel">
      <div class="flex h-full grow flex-col bg-white pl-[var(--main-sidebar-width)] dark:bg-navy-750">
        <!-- Sidebar Panel Header -->
        <div class="flex h-18 w-full items-center justify-between pl-4 pr-1">
          <p class="text-base tracking-wider text-slate-800 dark:text-navy-100">
            Edit Profile
          </p>
          <button @click="$store.global.isSidebarExpanded = false" class="btn size-7 rounded-full p-0 text-primary hover:bg-slate-300/20 focus:bg-slate-300/20 active:bg-slate-300/25 dark:text-accent-light/80 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25 xl:hidden">
            <svg xmlns="http://www.w3.org/2000/svg" class="size-6" fill="none" viewbox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
          </button>
        </div>

        <!-- Sidebar Panel Body -->
        <div x-data="{expandedItem:null}" class="h-[calc(100%-4.5rem)] overflow-x-hidden pb-6" x-init="$el._x_simplebar = new SimpleBar($el);">
          <ul class="flex flex-1 flex-col px-4 font-inter">
            <li>
              <a x-data="navLink" class="flex py-2 text-xs+ tracking-wide outline-none transition-colors duration-300 ease-in-out text-slate-600 hover:text-slate-900 dark:text-navy-200 dark:hover:text-navy-50">
                Edit your profile and login details.<br>
                <br>Note: Deleting your account will permanently remove all your bookings and personal information.
              </a>
            </li>
          </ul>

            <ul class="flex flex-1 flex-col px-4 font-inter mt-4">
                <li>
                    <p class="py-2 text-xs+ tracking-wide text-slate-500 dark:text-navy-300">
                        Today's Date: <span x-text="formattedDate"></span>
                    </p>
                </li>
            </ul>
        </div>
      </div>
    </div>
  </div>

    <!-- User Authentication & Profile Alpine Component -->
    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.data('sidebarUser', () => ({
                userAvatar: '../images/avatar/avatar-12.jpg', // Default avatar
                userName: 'Lyk-no-boss', // Using the provided username from metadata
                userRole: 'Customer',
                formattedDate: '',

                init() {
                    // Format today's date
                    const now = new Date();
                    this.formattedDate = now.toLocaleDateString('en-US', {
                        weekday: 'long',
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });

                    // Check if user is logged in
                    this.checkUserAuth();

                    // Redirect to login if not authenticated
                    if (!this.isAuthenticated()) {
                        window.location.href = '../auth/sign_in.html';
                    }
                },

                checkUserAuth() {
                    const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');

                    if (currentUser && currentUser.id) {
                        // Set user information
                        this.userName = currentUser.firstName && currentUser.lastName ?
                            `${currentUser.firstName} ${currentUser.lastName}` :
                            (currentUser.username || 'Lyk-no-boss');

                        this.userRole = this.capitalizeFirstLetter(currentUser.role || 'Customer');

                        // Set avatar if available
                        if (currentUser.avatar &&
                            currentUser.avatar !== 'null' &&
                            currentUser.avatar !== 'undefined') {
                            this.userAvatar = currentUser.avatar;
                        }
                    }
                },

                isAuthenticated() {
                    const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
                    return !!currentUser.id;
                },

                capitalizeFirstLetter(string) {
                    return string.charAt(0).toUpperCase() + string.slice(1);
                },

                logout() {
                    // Clear user data from localStorage
                    localStorage.removeItem('currentUser');

                    // Redirect to login page
                    window.location.href = '../auth/sign_in.html';
                }
            }));
        });
    </script>

  <!-- App Header Wrapper-->
  <nav class="header before:bg-white dark:before:bg-navy-750 print:hidden">
    <!-- App Header  -->
    <div class="header-container relative flex w-full bg-white dark:bg-navy-750 print:hidden">
      <!-- Header Items -->
      <div class="flex w-full items-center justify-between">

        <!-- Left: Sidebar Toggle Button -->
        <div class="size-7">
          <button class="menu-toggle ml-0.5 flex size-7 flex-col justify-center space-y-1.5 text-primary outline-none focus:outline-none dark:text-accent-light/80" :class="$store.global.isSidebarExpanded && 'active'" @click="$store.global.isSidebarExpanded = !$store.global.isSidebarExpanded">
            <span></span>
            <span></span>
            <span></span>
          </button>
        </div>

        <!-- Right: Header buttons -->
        <div class="-mr-1.5 flex items-center space-x-2">



          <!-- Dark Mode Toggle -->
          <button @click="$store.global.isDarkModeEnabled = !$store.global.isDarkModeEnabled" class="btn size-8 rounded-full p-0 hover:bg-slate-300/20 focus:bg-slate-300/20 active:bg-slate-300/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25">
            <svg x-show="$store.global.isDarkModeEnabled" x-transition:enter="transition-transform duration-200 ease-out absolute origin-top" x-transition:enter-start="scale-75" x-transition:enter-end="scale-100 static" class="size-6 text-amber-400" fill="currentColor" viewbox="0 0 24 24">
              <path d="M11.75 3.412a.818.818 0 01-.07.917 6.332 6.332 0 00-1.4 3.971c0 3.564 2.98 6.494 6.706 6.494a6.86 6.86 0 002.856-.617.818.818 0 011.1 1.047C19.593 18.614 16.218 21 12.283 21 7.18 21 3 16.973 3 11.956c0-4.563 3.46-8.31 7.925-8.948a.818.818 0 01.826.404z"></path>
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" x-show="!$store.global.isDarkModeEnabled" x-transition:enter="transition-transform duration-200 ease-out absolute origin-top" x-transition:enter-start="scale-75" x-transition:enter-end="scale-100 static" class="size-6 text-amber-400" viewbox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path>
            </svg>
          </button>

          <!-- Monochrome Mode Toggle -->
          <button @click="$store.global.isMonochromeModeEnabled = !$store.global.isMonochromeModeEnabled" class="btn size-8 rounded-full p-0 hover:bg-slate-300/20 focus:bg-slate-300/20 active:bg-slate-300/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25">
            <i class="fa-solid fa-palette bg-gradient-to-r from-sky-400 to-blue-600 bg-clip-text text-lg font-semibold text-transparent"></i>
          </button>

          <!-- Right Sidebar home page icon -->
          <button
                  @click="window.location.href = '../all_users/homepage.html'; $store.global.isRightSidebarExpanded = true"
                  class="btn size-8 rounded-full p-0 hover:bg-slate-300/20 focus:bg-slate-300/20 active:bg-slate-300/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25"
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="size-5.5 text-slate-500 dark:text-navy-100" fill="none" viewbox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path>
            </svg>
          </button>

        </div>
      </div>
    </div>
  </nav>


  <!-- Main Content Wrapper -->
  <main class="main-content w-full px-[var(--margin-x)] pb-8">
    <div x-data="profileManager()" x-init="init()">
      <div class="flex items-center space-x-4 py-5 lg:py-6">
        <h2 class="text-xl font-medium text-slate-800 dark:text-navy-50 lg:text-2xl">
          Edit Profile
        </h2>
        <div class="hidden h-full py-1 sm:flex">
          <div class="h-full w-px bg-slate-300 dark:bg-navy-600"></div>
        </div>
        <ul class="hidden flex-wrap items-center space-x-2 sm:flex">
          <li class="flex items-center space-x-2">
            <a class="text-primary transition-colors hover:text-primary-focus dark:text-accent-light dark:hover:text-accent" href="#">User</a>
            <svg x-ignore="" xmlns="http://www.w3.org/2000/svg" class="size-4" fill="none" viewbox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </li>
          <li>Account Settings</li>
        </ul>
      </div>

      <div class="grid grid-cols-12 gap-4 sm:gap-5 lg:gap-6">
        <!-- Left Column: User Details -->
        <div class="col-span-12 lg:col-span-8">
          <div class="card">
            <div class="flex flex-col items-center space-y-4 border-b border-slate-200 p-4 dark:border-navy-500 sm:flex-row sm:justify-between sm:space-y-0 sm:px-5">
              <div class="flex items-center space-x-4">
                <div class="avatar size-20">
                  <img class="mask is-squircle" :src="user.avatarPreview || user.avatar" alt="avatar">
                </div>
                <div>
                  <h3 class="text-xl font-medium text-slate-700 dark:text-navy-100" x-text="`${user.firstName} ${user.lastName}`"></h3>
                  <p class="text-sm+ text-slate-500 dark:text-navy-300" x-text="user.role"></p>
                </div>
              </div>
              <label class="btn border border-info/30 bg-info/10 font-medium text-info hover:bg-info/20 focus:bg-info/20 active:bg-info/25 cursor-pointer">
                Change Avatar
                <input id="avatar-upload" type="file" @change="handleAvatarUpload" class="hidden" accept="image/*">
              </label>
            </div>
            <div class="p-4 sm:p-5">
              <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <label class="block">
                  <span>First Name</span>
                  <input x-model="user.firstName" class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2" placeholder="First Name" type="text">
                </label>
                <label class="block">
                  <span>Last Name</span>
                  <input x-model="user.lastName" class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2" placeholder="Last Name" type="text">
                </label>
                <label class="block">
                  <span>Email Address</span>
                  <input x-model="user.email" class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2" placeholder="Email Address" type="email">
                </label>
                <label class="block">
                  <span>Phone Number</span>
                  <input x-model="user.phone" class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2" placeholder="Phone Number" type="text">
                </label>
                <label class="block">
                  <span>Date of Birth</span>
                  <input x-model="user.dob" class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2" type="date">

                </label>
                <label class="block">
                  <span>Address</span>
                  <input x-model="user.address" class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2" placeholder="User Address" type="text">
                </label>
              </div>
              <div class="my-7 h-px bg-slate-200 dark:bg-navy-500"></div>
              <div class="flex justify-end space-x-2">
                <button @click="resetForm()" class="btn border border-warning/30 bg-warning/10 font-medium text-warning hover:bg-warning/20 focus:bg-warning/20 active:bg-warning/25">Cancel</button>
                <button @click="saveUserProfile()" class="btn border border-primary/30 bg-primary/10 font-medium text-primary hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25 dark:border-accent-light/30 dark:bg-accent-light/10 dark:text-accent-light dark:hover:bg-accent-light/20 dark:focus:bg-accent-light/20 dark:active:bg-accent-light/25">Save Changes</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Right Column: Security -->
        <div class="col-span-12 lg:col-span-4">
          <div class="space-y-4 sm:space-y-5 lg:space-y-6">
            <!-- Change Password Card -->
            <div class="card">
              <div class="border-b border-slate-200 p-4 dark:border-navy-500 sm:px-5">
                <h3 class="text-base font-medium text-slate-700 dark:text-navy-100">Change Password</h3>
              </div>
              <div class="p-4 sm:p-5 space-y-4">
                <label class="block">
                  <span>Current Password</span>
                  <span class="relative mt-1.5 flex">
                  <input :type="showCurrentPass ? 'text' : 'password'" x-model="password.current" class="form-input peer w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2 pl-9" placeholder="Current Password">
                  <span class="pointer-events-none absolute flex h-full w-10 items-center justify-center text-slate-400 peer-focus:text-primary dark:text-navy-300 dark:peer-focus:text-accent"><i class="fa-solid fa-lock"></i></span>
                  <button @click="showCurrentPass = !showCurrentPass" class="absolute right-0 flex h-full w-10 items-center justify-center text-slate-400 hover:text-slate-500">
                    <i class="fas" :class="showCurrentPass ? 'fa-eye-slash' : 'fa-eye'"></i>
                  </button>
                </span>
                </label>
                <label class="block">
                  <span>New Password</span>
                  <span class="relative mt-1.5 flex">
                  <input :type="showNewPass ? 'text' : 'password'" x-model="password.new" class="form-input peer w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2 pl-9" placeholder="New Password">
                  <span class="pointer-events-none absolute flex h-full w-10 items-center justify-center text-slate-400 peer-focus:text-primary dark:text-navy-300 dark:peer-focus:text-accent"><i class="fa-solid fa-lock"></i></span>
                  <button @click="showNewPass = !showNewPass" class="absolute right-0 flex h-full w-10 items-center justify-center text-slate-400 hover:text-slate-500">
                    <i class="fas" :class="showNewPass ? 'fa-eye-slash' : 'fa-eye'"></i>
                  </button>
                </span>
                </label>
                <label class="block">
                  <span>Confirm New Password</span>
                  <span class="relative mt-1.5 flex">
                  <input :type="showConfirmPass ? 'text' : 'password'" x-model="password.confirm" class="form-input peer w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2 pl-9" placeholder="Confirm Password">
                  <span class="pointer-events-none absolute flex h-full w-10 items-center justify-center text-slate-400 peer-focus:text-primary dark:text-navy-300 dark:peer-focus:text-accent"><i class="fa-solid fa-lock"></i></span>
                  <button @click="showConfirmPass = !showConfirmPass" class="absolute right-0 flex h-full w-10 items-center justify-center text-slate-400 hover:text-slate-500">
                    <i class="fas" :class="showConfirmPass ? 'fa-eye-slash' : 'fa-eye'"></i>
                  </button>
                </span>
                </label>
                <button @click="changePassword()" class="btn w-full border border-info/30 bg-info/10 font-medium text-info hover:bg-info/20 focus:bg-info/20 active:bg-info/25">
                  Change Password
                </button>
              </div>
            </div>

            <!-- Delete Account Card -->
            <div class="card">
              <div class="border-b border-slate-200 p-4 dark:border-navy-500 sm:px-5">
                <h3 class="text-base font-medium text-error">Delete Account</h3>
              </div>
              <div class="p-4 sm:p-5 space-y-4">
                <p class="text-sm+">
                  This action is permanent and cannot be undone. All your data will be erased.
                </p>
                <label class="block">
                  <span>To confirm, type "DELETE"</span>
                  <textarea x-model="deleteConfirmation" rows="2" class="form-textarea mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent p-2.5"></textarea>
                </label>
                <button
                        @click="showDeleteConfirmModal = true"
                        :disabled="deleteConfirmation !== 'DELETE'"
                        class="btn w-full border border-error/30 bg-error/10 font-medium text-error hover:bg-error/20 focus:bg-error/20 active:bg-error/25"
                        :class="{'opacity-50 cursor-not-allowed': deleteConfirmation !== 'DELETE'}"
                >
                  Delete Account
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Modals -->
      <template x-teleport="#x-teleport-target">
        <div>
          <!-- Delete Confirmation Modal -->
          <div
                  class="fixed inset-0 z-[100] flex flex-col items-center justify-center overflow-hidden px-4 py-6 sm:px-5"
                  x-show="showDeleteConfirmModal"
                  role="dialog"
                  @keydown.window.escape="showDeleteConfirmModal = false"
          >
            <div
                    class="absolute inset-0 bg-slate-900/60 backdrop-blur transition-opacity duration-300"
                    @click="showDeleteConfirmModal = false"
                    x-show="showDeleteConfirmModal"
                    x-transition:enter="ease-out" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
                    x-transition:leave="ease-in" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0"
            ></div>
            <div
                    class="relative max-w-lg rounded-lg bg-white px-4 py-10 text-center transition-opacity duration-300 dark:bg-navy-700 sm:px-5"
                    x-show="showDeleteConfirmModal"
                    x-transition:enter="ease-out" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
                    x-transition:leave="ease-in" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0"
            >
              <i class="fa-solid fa-triangle-exclamation text-6xl text-warning"></i>
              <div class="mt-4">
                <h2 class="text-2xl text-slate-700 dark:text-navy-100">Are you sure?</h2>
                <p class="mt-2">You are about to delete your account. This action is permanent and cannot be undone.</p>
                <div class="mt-6 space-x-3">
                  <button @click="showDeleteConfirmModal = false" class="btn bg-slate-200 font-medium text-slate-700 hover:bg-slate-300">Cancel</button>
                  <button @click="deleteAccount()" class="btn bg-error font-medium text-white hover:bg-error-focus">Yes, Delete</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Success Modal -->
          <div
                  class="fixed inset-0 z-[100] flex flex-col items-center justify-center overflow-hidden px-4 py-6 sm:px-5"
                  x-show="showSuccessModal"
                  role="dialog"
                  @keydown.window.escape="showSuccessModal = false"
          >
            <div
                    class="absolute inset-0 bg-slate-900/60 backdrop-blur transition-opacity duration-300"
                    @click="showSuccessModal = false"
                    x-show="showSuccessModal"
                    x-transition:enter="ease-out" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
                    x-transition:leave="ease-in" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0"
            ></div>
            <div
                    class="relative max-w-lg rounded-lg bg-white px-4 py-10 text-center transition-opacity duration-300 dark:bg-navy-700 sm:px-5"
                    x-show="showSuccessModal"
                    x-transition:enter="ease-out" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
                    x-transition:leave="ease-in" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0"
            >
              <svg xmlns="http://www.w3.org/2000/svg" class="inline size-28 text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <div class="mt-4">
                <h2 class="text-2xl text-slate-700 dark:text-navy-100" x-text="modalTitle"></h2>
                <p class="mt-2" x-text="modalText"></p>
                <button @click="handleModalClose()" class="btn mt-6 bg-success font-medium text-white hover:bg-success-focus focus:bg-success-focus active:bg-success-focus/90">
                  Close
                </button>
              </div>
            </div>
          </div>

          <!-- Error Modal -->
          <div
                  class="fixed inset-0 z-[100] flex flex-col items-center justify-center overflow-hidden px-4 py-6 sm:px-5"
                  x-show="showErrorModal"
                  role="dialog"
                  @keydown.window.escape="showErrorModal = false"
          >
            <div
                    class="absolute inset-0 bg-slate-900/60 backdrop-blur transition-opacity duration-300"
                    @click="showErrorModal = false"
                    x-show="showErrorModal"
                    x-transition:enter="ease-out" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
                    x-transition:leave="ease-in" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0"
            ></div>
            <div
                    class="relative max-w-lg rounded-lg bg-white px-4 py-10 text-center transition-opacity duration-300 dark:bg-navy-700 sm:px-5"
                    x-show="showErrorModal"
                    x-transition:enter="ease-out" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
                    x-transition:leave="ease-in" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0"
            >
              <svg xmlns="http://www.w3.org/2000/svg" class="inline size-28 text-error" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              <div class="mt-4">
                <h2 class="text-2xl text-slate-700 dark:text-navy-100" x-text="modalTitle"></h2>
                <p class="mt-2" x-text="modalText"></p>
                <button @click="showErrorModal = false" class="btn mt-6 bg-error font-medium text-white hover:bg-error-focus focus:bg-error-focus active:bg-error-focus/90">
                  Close
                </button>
              </div>
            </div>
          </div>
        </div>
      </template>
    </div>
  </main>

</div>
<!--
    This is a place for Alpine.js Teleport feature
    @see https://alpinejs.dev/directives/teleport
  -->
<div id="x-teleport-target"></div>
<script>
  window.addEventListener("DOMContentLoaded", () => Alpine.start());
</script>

<!-- Include the profile manager script -->
<script src="../assets/js/profile-manager.js"></script>

</body>
</html>
