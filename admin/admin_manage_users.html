<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Meta tags  -->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">

  <title>Manage Users</title>
    <link rel="icon" type="image/png" href="../img/about-img.png">

  <!-- CSS Assets -->
  <link rel="stylesheet" href="../assets/css/app.css">

  <!-- Javascript Assets -->
  <script src="../assets/js/app.js" defer=""></script>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
  <link href="css2?family=Inter:wght@400;500;600;700&family=Poppins:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
  <script>
    /**
     * THIS SCRIPT REQUIRED FOR PREVENT FLICKERING IN SOME BROWSERS
     */
    localStorage.getItem("_x_darkMode_on") === "true" &&
    document.documentElement.classList.add("dark");
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Get current user from localStorage
      const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');

      // Only allow admins to stay on the page
      if (!currentUser || !currentUser.id || currentUser.role !== 'admin') {
        // Redirect non-admin users to homepage (or another appropriate page)
        window.location.href = '../all_users/homepage.html';
      }
      // If the user is admin, they stay on the page
    });
  </script>

  <style>
    .pad{
      padding:3rem 4rem 0 4rem;
    }
  </style>
</head>

<body x-data="" class="is-header-blur" x-bind="$store.global.documentBody">
<!-- App preloader-->
<div class="app-preloader fixed z-50 grid h-full w-full place-content-center bg-slate-50 dark:bg-navy-900">
  <div class="app-preloader-inner relative inline-block size-48"></div>
</div>

<!-- Page Wrapper -->
<div id="root" class="min-h-100vh flex grow bg-slate-50 dark:bg-navy-900" x-cloak="">

  <!-- Sidebar -->
  <div class="sidebar print:hidden" x-data="sidebarUser()">
    <!-- Main Sidebar -->
    <div class="main-sidebar">
      <div class="flex h-full w-full flex-col items-center border-r border-slate-150 bg-white dark:border-navy-700 dark:bg-navy-800">

        <!-- Application Logo -->
        <div class="flex pt-4">
          <!-- Profile -->
          <div x-data="usePopper({placement:'right-end',offset:12})" @click.outside="isShowPopper && (isShowPopper = false)" class="flex">
            <button @click="isShowPopper = !isShowPopper" x-ref="popperRef" class="avatar size-12">
              <img class="rounded-full" :src="userAvatar" :alt="userName" onerror="this.src='../images/avatar/avatar-12.jpg'">
              <span class="absolute right-0 size-3.5 rounded-full border-2 border-white bg-success dark:border-navy-700"></span>
            </button>

            <div :class="isShowPopper && 'show'" class="popper-root fixed" x-ref="popperRoot">
              <div class="popper-box w-64 rounded-lg border border-slate-150 bg-white shadow-soft dark:border-navy-600 dark:bg-navy-700">
                <div class="flex items-center space-x-4 rounded-t-lg bg-slate-100 py-5 px-4 dark:bg-navy-800">
                  <div class="avatar size-14">
                    <img class="rounded-full" :src="userAvatar" :alt="userName" onerror="this.src='../images/avatar/avatar-12.jpg'">
                  </div>
                  <div>
                    <a href="#" class="text-base font-medium text-slate-700 hover:text-primary focus:text-primary dark:text-navy-100 dark:hover:text-accent-light dark:focus:text-accent-light" x-text="userName">
                      Lyk-no-boss
                    </a>
                    <p class="text-xs text-slate-400 dark:text-navy-300" x-text="userRole">
                      User
                    </p>
                  </div>
                </div>
                <div class="flex flex-col pt-2 pb-5">
                  <a href="../all_users/homepage.html" class="group flex items-center space-x-3 py-2 px-4 tracking-wide outline-none transition-all hover:bg-slate-100 focus:bg-slate-100 dark:hover:bg-navy-600 dark:focus:bg-navy-600">
                    <div class="flex size-8 items-center justify-center rounded-lg bg-error text-white">
                      <svg xmlns="http://www.w3.org/2000/svg" class="size-4.5" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                      </svg>
                    </div>
                    <div>
                      <h2 class="font-medium text-slate-700 transition-colors group-hover:text-primary group-focus:text-primary dark:text-navy-100 dark:group-hover:text-accent-light dark:group-focus:text-accent-light">
                        Home Page
                      </h2>
                      <div class="text-xs text-slate-400 line-clamp-1 dark:text-navy-300">
                        Go to home page
                      </div>
                    </div>
                  </a>

                  <div class="mt-3 px-4">
                    <button @click="logout" class="btn h-9 w-full space-x-2 bg-primary text-white hover:bg-primary-focus focus:bg-primary-focus active:bg-primary-focus/90 dark:bg-accent dark:hover:bg-accent-focus dark:focus:bg-accent-focus dark:active:bg-accent/90">
                      <svg xmlns="http://www.w3.org/2000/svg" class="size-5" fill="none" viewbox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                      </svg>
                      <span>Logout</span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Main Sections Links -->
        <div class="is-scrollbar-hidden flex grow flex-col space-y-4 overflow-y-auto pt-6">
          <!-- Dashobards -->
          <a href="admin_dashboard.html" class="flex size-11 items-center justify-center rounded-lg outline-none transition-colors duration-200 hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25" x-tooltip.placement.right="'Dashboards'">
            <svg class="size-7" xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24">
              <path fill="currentColor" fill-opacity=".3" d="M5 14.059c0-1.01 0-1.514.222-1.945.221-.43.632-.724 1.453-1.31l4.163-2.974c.56-.4.842-.601 1.162-.601.32 0 .601.2 1.162.601l4.163 2.974c.821.586 1.232.88 1.453 1.31.222.43.222.935.222 1.945V19c0 .943 0 1.414-.293 1.707C18.414 21 17.943 21 17 21H7c-.943 0-1.414 0-1.707-.293C5 20.414 5 19.943 5 19v-4.94Z"></path>
              <path fill="currentColor" d="M3 12.387c0 .267 0 .4.084.441.084.041.19-.04.4-.204l7.288-5.669c.59-.459.885-.688 1.228-.688.343 0 .638.23 1.228.688l7.288 5.669c.21.163.316.245.4.204.084-.04.084-.174.084-.441v-.409c0-.48 0-.72-.102-.928-.101-.208-.291-.355-.67-.65l-7-5.445c-.59-.459-.885-.688-1.228-.688-.343 0-.638.23-1.228.688l-7 5.445c-.379.295-.569.442-.67.65-.102.208-.102.448-.102.928v.409Z"></path>
              <path fill="currentColor" d="M11.5 15.5h1A1.5 1.5 0 0 1 14 17v3.5h-4V17a1.5 1.5 0 0 1 1.5-1.5Z"></path>
              <path fill="currentColor" d="M17.5 5h-1a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5Z"></path>
            </svg>
          </a>

          <!-- Admin Bookings -->
          <a href="admin_bookings.html" class="flex size-11 items-center justify-center rounded-lg outline-none transition-colors duration-200 hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25" x-tooltip.placement.right="'Manage Bookings'">
            <svg class="size-7" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M9.85714 3H4.14286C3.51167 3 3 3.51167 3 4.14286V9.85714C3 10.4883 3.51167 11 4.14286 11H9.85714C10.4883 11 11 10.4883 11 9.85714V4.14286C11 3.51167 10.4883 3 9.85714 3Z" fill="currentColor"></path>
              <path d="M9.85714 12.8999H4.14286C3.51167 12.8999 3 13.4116 3 14.0428V19.757C3 20.3882 3.51167 20.8999 4.14286 20.8999H9.85714C10.4883 20.8999 11 20.3882 11 19.757V14.0428C11 13.4116 10.4883 12.8999 9.85714 12.8999Z" fill="currentColor" fill-opacity="0.3"></path>
              <path d="M19.757 3H14.0428C13.4116 3 12.8999 3.51167 12.8999 4.14286V9.85714C12.8999 10.4883 13.4116 11 14.0428 11H19.757C20.3882 11 20.8999 10.4883 20.8999 9.85714V4.14286C20.8999 3.51167 20.3882 3 19.757 3Z" fill="currentColor" fill-opacity="0.3"></path>
              <path d="M19.757 12.8999H14.0428C13.4116 12.8999 12.8999 13.4116 12.8999 14.0428V19.757C12.8999 20.3882 13.4116 20.8999 14.0428 20.8999H19.757C20.3882 20.8999 20.8999 20.3882 20.8999 19.757V14.0428C20.8999 13.4116 20.3882 12.8999 19.757 12.8999Z" fill="currentColor" fill-opacity="0.3"></path>
            </svg>
          </a>

          <!-- My Bookings -->
          <a href="admin_customer_bookings.html" class="flex size-11 items-center justify-center rounded-lg outline-none transition-colors duration-200 hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25" x-tooltip.placement.right="'My Bookings'">
            <svg class="size-7" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-opacity="0.5" d="M14.2498 16C14.2498 17.5487 13.576 18.9487 12.4998 19.9025C11.5723 20.7425 10.3473 21.25 8.99976 21.25C6.10351 21.25 3.74976 18.8962 3.74976 16C3.74976 13.585 5.39476 11.5375 7.61726 10.9337C8.22101 12.4562 9.51601 13.6287 11.1173 14.0662C11.5548 14.1887 12.0185 14.25 12.4998 14.25C12.981 14.25 13.4448 14.1887 13.8823 14.0662C14.1185 14.6612 14.2498 15.3175 14.2498 16Z" fill="currentColor"></path>
              <path d="M17.75 9.00012C17.75 9.68262 17.6187 10.3389 17.3825 10.9339C16.7787 12.4564 15.4837 13.6289 13.8825 14.0664C13.445 14.1889 12.9813 14.2501 12.5 14.2501C12.0187 14.2501 11.555 14.1889 11.1175 14.0664C9.51625 13.6289 8.22125 12.4564 7.6175 10.9339C7.38125 10.3389 7.25 9.68262 7.25 9.00012C7.25 6.10387 9.60375 3.75012 12.5 3.75012C15.3962 3.75012 17.75 6.10387 17.75 9.00012Z" fill="currentColor"></path>
              <path fill-opacity="0.3" d="M21.25 16C21.25 18.8962 18.8962 21.25 16 21.25C14.6525 21.25 13.4275 20.7425 12.5 19.9025C13.5763 18.9487 14.25 17.5487 14.25 16C14.25 15.3175 14.1187 14.6612 13.8825 14.0662C15.4837 13.6287 16.7787 12.4562 17.3825 10.9337C19.605 11.5375 21.25 13.585 21.25 16Z" fill="currentColor"></path>
            </svg>
          </a>

          <!-- Forms -->
          <a href="admin_forms.html" class="flex size-11 items-center justify-center rounded-lg outline-none transition-colors duration-200 hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25" x-tooltip.placement.right="'Manage Forms'">
              <svg class="size-7" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
                  <rect x="2" y="10" width="20" height="10" rx="1.5" fill="currentColor" fill-opacity="0.20"/>
                  <rect x="3.5" y="5.5" width="17" height="10" rx="1.5" fill="currentColor" fill-opacity="0.45"/>
                  <rect x="6" y="1" width="12" height="8" rx="1.25" fill="currentColor" fill-opacity="0.95"/>
                  <line x1="8" y1="3.5" x2="16" y2="3.5" stroke="white" stroke-width="1" stroke-linecap="round" opacity="0.95"/>
                  <line x1="8" y1="5.5" x2="14" y2="5.5" stroke="white" stroke-width="1" stroke-linecap="round" opacity="0.95"/>
              </svg>
          </a>

          <!-- Submit Forms -->
          <a href="admin_customer_forms.html" class="flex size-11 items-center justify-center rounded-lg outline-none transition-colors duration-200 hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25" x-tooltip.placement.right="'Submit Forms'">
              <svg class="size-7" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M7 2a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V8.828a2 2 0 0 0-.586-1.414l-5.828-5.828A2 2 0 0 0 13.172 2H7zm5 1.414L19 9.414V20a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5v2a1 1 0 0 0 1 1zM8 13h8v2H8v-2zm0-4h8v2H8V9z" fill="currentColor"/>
              </svg>
          </a>

          <!-- Chat -->
          <a href="admin_chat.html" class="flex size-11 items-center justify-center rounded-lg outline-none transition-colors duration-200 hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25" x-tooltip.placement.right="'Chat'">
            <svg xmlns="http://www.w3.org/2000/svg" class="size-7" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M8 10h.01M12 10h.01M16 10h.01M21 12c0 4.418-4.03 8-9 8a9.009 9.009 0 01-5-1.563l-4.223.885.898-4.21A8.962 8.962 0 013 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
            </svg>
          </a>

          <!-- Users - Active Page -->
            <a href="admin_manage_users.html" class="flex size-11 items-center justify-center rounded-lg bg-primary/10 text-primary outline-none transition-colors duration-200 hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25 dark:bg-navy-600 dark:text-accent-light dark:hover:bg-navy-450 dark:focus:bg-navy-450 dark:active:bg-navy-450/90" x-tooltip.placement.right="'Manage Users'">
                  <!-- UPDATED ICON: Users / Manage Users (only the SVG changed) -->
                  <svg xmlns="http://www.w3.org/2000/svg" class="size-7" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <!-- Two person heads -->
                      <path stroke-linecap="round" stroke-linejoin="round" d="M9 11a4 4 0 100-8 4 4 0 000 8zM17 13a3 3 0 100-6 3 3 0 000 6z"/>
                      <!-- Primary user body -->
                      <path stroke-linecap="round" stroke-linejoin="round" d="M3 20.25a6.75 6.75 0 0113.5 0V21a.75.75 0 01-.75.75H3.75A.75.75 0 013 21v-.75z"/>
                      <!-- Secondary user body (smaller, to the right) -->
                      <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 21.75a.75.75 0 01-.75-.75v-.75a7.46 7.46 0 01.6-2.97 5.25 5.25 0 015.4 0A7.46 7.46 0 0122.5 20.25v.75a.75.75 0 01-.75.75h-5.25z"/>
                  </svg>
              </a>

            <!-- staff -->
            <a href="admin_manage_staff.html" class="flex size-11 items-center justify-center rounded-lg outline-none transition-colors duration-200 hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25" x-tooltip.placement.right="'Manage Staff'">
                <!-- UPDATED ICON (different users-style icon) -->
                <svg xmlns="http://www.w3.org/2000/svg" class="size-7" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <!-- Center user -->
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M12 12.5c2.071 0 3.75-1.679 3.75-3.75S14.071 5 12 5s-3.75 1.679-3.75 3.75S9.929 12.5 12 12.5z"/>
                    <!-- Left user (behind) -->
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M6.25 11.25A3 3 0 106.26 5.5"/>
                    <!-- Right user (behind) -->
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M17.75 11.25A3 3 0 1017.74 5.5"/>
                    <!-- Center body -->
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M6.75 18.5c0-2.9 2.66-5.25 5.25-5.25s5.25 2.35 5.25 5.25v.75a.75.75 0 01-.75.75H7.5a.75.75 0 01-.75-.75v-.75z"/>
                    <!-- Side bodies (outline suggestion of group) -->
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M3.5 19c0-2.1 1.44-3.95 3.17-4.57M20.5 19c0-2.1-1.44-3.95-3.17-4.57"/>
                </svg>
            </a>

            <!-- Cars -->
            <a href="admin_manage_cars.html"
               class="flex size-11 items-center justify-center rounded-lg outline-none transition-colors duration-200 hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25"
               x-tooltip.placement.right="'Manage Cars'">
                <!-- Replaced icon with a car icon (only change) -->
                <svg xmlns="http://www.w3.org/2000/svg"
                     class="size-7"
                     fill="none"
                     viewBox="0 0 24 24"
                     stroke="currentColor"
                     stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M3 13h18l-1.5-4.5a2 2 0 0 0-1.9-1.4H6.4a2 2 0 0 0-1.9 1.4L3 13Z"/>
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M3 13v5a1 1 0 0 0 1 1h1.2a2 2 0 0 0 3.6 0h6.4a2 2 0 0 0 3.6 0H20a1 1 0 0 0 1-1v-5"/>
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M6 13l1-3h10l1 3"/>
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M7.5 18h.01M16.5 18h.01"/>
                </svg>
            </a>
        </div>

        <!-- Bottom Links -->
        <div class="flex flex-col items-center space-y-3 py-3">
          <!-- Settings -->
          <a href="admin_edit_profile.html" class="flex size-11 items-center justify-center rounded-lg outline-none transition-colors duration-200 hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25">
            <svg class="size-7" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-opacity="0.3" fill="currentColor" d="M2 12.947v-1.771c0-1.047.85-1.913 1.899-1.913 1.81 0 2.549-1.288 1.64-2.868a1.919 1.919 0 0 1 .699-2.607l1.729-.996c.79-.474 1.81-.192 2.279.603l.11.192c.9 1.58 2.379 1.58 3.288 0l.11-.192c.47-.795 1.49-1.077 2.279-.603l1.73.996a1.92 1.92 0 0 1 .699 2.607c-.91 1.58-.17 2.868 1.639 2.868 1.04 0 1.899.856 1.899 1.912v1.772c0 1.047-.85 1.912-1.9 1.912-1.808 0-2.548 1.288-1.638 2.869.52.915.21 2.083-.7 2.606l-1.729.997c-.79.473-1.81.191-2.279-.604l-.11-.191c-.9-1.58-2.379-1.58-3.288 0l-.11.19c-.47.796-1.49 1.078-2.279.605l-1.73-.997a1.919 1.919 0 0 1-.699-2.606c.91-1.58.17-2.869-1.639-2.869A1.911 1.911 0 0 1 2 12.947Z"></path>
              <path fill="currentColor" d="M11.995 15.332c1.794 0 3.248-1.464 3.248-3.27 0-1.807-1.454-3.272-3.248-3.272-1.794 0-3.248 1.465-3.248 3.271 0 1.807 1.454 3.271 3.248 3.271Z"></path>
            </svg>
          </a>
        </div>
      </div>
    </div>

    <!-- Sidebar Panel -->
    <div class="sidebar-panel">
      <div class="flex h-full grow flex-col bg-white pl-[var(--main-sidebar-width)] dark:bg-navy-750">
        <!-- Sidebar Panel Header -->
        <div class="flex h-18 w-full items-center justify-between pl-4 pr-1">
          <p class="text-base tracking-wider text-slate-800 dark:text-navy-100">
            Manage Users
          </p>
          <button @click="$store.global.isSidebarExpanded = false" class="btn size-7 rounded-full p-0 text-primary hover:bg-slate-300/20 focus:bg-slate-300/20 active:bg-slate-300/25 dark:text-accent-light/80 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25 xl:hidden">
            <svg xmlns="http://www.w3.org/2000/svg" class="size-6" fill="none" viewbox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
          </button>
        </div>

        <!-- Sidebar Panel Body -->
        <div x-data="{expandedItem:null}" class="h-[calc(100%-4.5rem)] overflow-x-hidden pb-6" x-init="$el._x_simplebar = new SimpleBar($el);">
          <ul class="flex flex-1 flex-col px-4 font-inter">
            <li>
              <a x-data="navLink" class="flex py-2 text-xs+ tracking-wide outline-none transition-colors duration-300 ease-in-out text-slate-600 hover:text-slate-900 dark:text-navy-200 dark:hover:text-navy-50">
                Browse through the user list — you can edit, add, or delete a user. Please note that all actions are permanent.
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- User Authentication & Profile Alpine Component -->
  <script>
    document.addEventListener('alpine:init', () => {
      Alpine.data('sidebarUser', () => ({
        userAvatar: '../images/avatar/avatar-12.jpg', // Default avatar
        userName: 'Lyk-no-boss', // Using the provided username
        userRole: 'User',
        currentDate: '2025-08-06', // From provided date

        init() {
          // Check if user is logged in
          this.checkUserAuth();

          // Redirect to login if not authenticated
          if (!this.isAuthenticated()) {
            window.location.href = '../auth/sign_in.html';
          }
        },

        checkUserAuth() {
          const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');

          if (currentUser && currentUser.id) {
            // Set user information
            this.userName = currentUser.firstName && currentUser.lastName ?
                    `${currentUser.firstName} ${currentUser.lastName}` :
                    (currentUser.username || 'Lyk-no-boss');

            this.userRole = this.capitalizeFirstLetter(currentUser.role || 'User');

            // Set avatar if available
            if (currentUser.avatar &&
                    currentUser.avatar !== 'null' &&
                    currentUser.avatar !== 'undefined') {
              this.userAvatar = currentUser.avatar;
            }
          }
        },

        isAuthenticated() {
          const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
          return !!currentUser.id;
        },

        capitalizeFirstLetter(string) {
          return string.charAt(0).toUpperCase() + string.slice(1);
        },

        logout() {
          // Clear user data from localStorage
          localStorage.removeItem('currentUser');

          // Redirect to login page
          window.location.href = '../auth/sign_in.html';
        }
      }));
    });
  </script>

  <!-- App Header Wrapper-->
  <nav class="header before:bg-white dark:before:bg-navy-750 print:hidden">
    <!-- App Header  -->
    <div class="header-container relative flex w-full bg-white dark:bg-navy-750 print:hidden">
      <!-- Header Items -->
      <div class="flex w-full items-center justify-between">

        <!-- Left: Sidebar Toggle Button -->
        <div class="size-7">
          <button class="menu-toggle ml-0.5 flex size-7 flex-col justify-center space-y-1.5 text-primary outline-none focus:outline-none dark:text-accent-light/80" :class="$store.global.isSidebarExpanded && 'active'" @click="$store.global.isSidebarExpanded = !$store.global.isSidebarExpanded">
            <span></span>
            <span></span>
            <span></span>
          </button>
        </div>

        <!-- Right: Header buttons -->
        <div class="-mr-1.5 flex items-center space-x-2">



          <!-- Dark Mode Toggle -->
          <button @click="$store.global.isDarkModeEnabled = !$store.global.isDarkModeEnabled" class="btn size-8 rounded-full p-0 hover:bg-slate-300/20 focus:bg-slate-300/20 active:bg-slate-300/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25">
            <svg x-show="$store.global.isDarkModeEnabled" x-transition:enter="transition-transform duration-200 ease-out absolute origin-top" x-transition:enter-start="scale-75" x-transition:enter-end="scale-100 static" class="size-6 text-amber-400" fill="currentColor" viewbox="0 0 24 24">
              <path d="M11.75 3.412a.818.818 0 01-.07.917 6.332 6.332 0 00-1.4 3.971c0 3.564 2.98 6.494 6.706 6.494a6.86 6.86 0 002.856-.617.818.818 0 011.1 1.047C19.593 18.614 16.218 21 12.283 21 7.18 21 3 16.973 3 11.956c0-4.563 3.46-8.31 7.925-8.948a.818.818 0 01.826.404z"></path>
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" x-show="!$store.global.isDarkModeEnabled" x-transition:enter="transition-transform duration-200 ease-out absolute origin-top" x-transition:enter-start="scale-75" x-transition:enter-end="scale-100 static" class="size-6 text-amber-400" viewbox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path>
            </svg>
          </button>

          <!-- Monochrome Mode Toggle -->
          <button @click="$store.global.isMonochromeModeEnabled = !$store.global.isMonochromeModeEnabled" class="btn size-8 rounded-full p-0 hover:bg-slate-300/20 focus:bg-slate-300/20 active:bg-slate-300/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25">
            <i class="fa-solid fa-palette bg-gradient-to-r from-sky-400 to-blue-600 bg-clip-text text-lg font-semibold text-transparent"></i>
          </button>

          <!-- Right Sidebar home page icon -->
          <button
                  @click="window.location.href = '../all_users/homepage.html'; $store.global.isRightSidebarExpanded = true"
                  class="btn size-8 rounded-full p-0 hover:bg-slate-300/20 focus:bg-slate-300/20 active:bg-slate-300/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25"
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="size-5.5 text-slate-500 dark:text-navy-100" fill="none" viewbox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path>
            </svg>
          </button>

        </div>
      </div>
    </div>
  </nav>


    <!-- Main Content Wrapper -->
    <main class="main-content w-full pb-8">

        <div class="p-4 sm:p-5 lg:p-6" x-data="{
    showModal: false,
    editModal: false,
    deleteModal: false,
    showSuccessModal: false,
    showErrorModal: false,
    modalTitle: '',
    modalText: '',
    searchQuery: '',
    currentPage: 1,
    entriesPerPage: 10,
    users: [],
    isLoading: true,
    selectedUser: {},
    newUser: { firstName: '', lastName: '', email: '', phone: '', role: 'Customer', avatar: '', dob: '', address: '', newPassword: '', avatarPreview: null },

    /* ================== ADDED STATE FOR CURRENT USER ================== */
    currentUserId: null,         // ADDED
    currentUserEmail: null,      // ADDED (optional, in case you prefer filtering by email)

    // Initialize and load users from database
    init() {
      /* ================== MODIFIED: Resolve current user before fetching ================== */
      this.resolveCurrentUser();   // ADDED
      this.fetchUsers();
    },

    /* ================== ADDED: Resolve current logged-in user ID ================== */
    resolveCurrentUser() {
        // Try structured object
        const stored = this.safeParse(localStorage.getItem('currentUser'));
        if (stored && stored.id) {
            this.currentUserId = stored.id;
            this.currentUserEmail = stored.email || null;
            return;
        }
        // Fallback to legacy separate id storage
        const legacyId = localStorage.getItem('userId') || sessionStorage.getItem('userId');
        if (legacyId && /^\d+$/.test(legacyId)) {
            this.currentUserId = parseInt(legacyId, 10);
        }
    },

    /* ================== ADDED: Safe JSON parse helper ================== */
    safeParse(str) {
        if (!str) return null;
        try { return JSON.parse(str); } catch { return null; }
    },

    // Fetch users from database
    async fetchUsers() {
      try {
        this.isLoading = true;
        const response = await fetch('/admin/api/users');

        if (!response.ok) {
          throw new Error('Failed to fetch users');
        }

        const data = await response.json();

        this.users = data.map(user => ({
          id: user.id,
          firstName: user.first_name,
          lastName: user.last_name,
          email: user.email,
          phone: user.phone || '',
          role: user.role || 'Customer',
          avatar: user.avatar || '../images/avatar/default.jpg',
          dateAdded: this.formatDate(user.created_at),
          dob: user.dob || '',
          address: user.address || '',
          newPassword: '',
          avatarPreview: null
        }))
        /* ================== ADDED FILTER: Remove logged-in user from list ================== */
        .filter(u => {
            // If we have currentUserId, filter by id
            if (this.currentUserId) return u.id !== this.currentUserId;
            // Else if we have email, filter by email
            if (this.currentUserEmail) return u.email !== this.currentUserEmail;
            // If no info, keep all
            return true;
        });

      } catch (error) {
        console.error('Error fetching users:', error);
        this.handleError('Error', 'Failed to load users from database.');
      } finally {
        this.isLoading = false;
      }
    },

    get filteredUsers() {
        if (this.searchQuery === '') {
            return this.users;
        }
        return this.users.filter(user => {
            const search = this.searchQuery.toLowerCase();
            return user.firstName.toLowerCase().includes(search) ||
                   user.lastName.toLowerCase().includes(search) ||
                   user.email.toLowerCase().includes(search) ||
                   user.phone.toLowerCase().includes(search) ||
                   user.role.toLowerCase().includes(search);
        });
    },
    get totalPages() {
        return Math.ceil(this.filteredUsers.length / this.entriesPerPage);
    },
    get paginatedUsers() {
        const start = (this.currentPage - 1) * this.entriesPerPage;
        const end = start + this.entriesPerPage;
        return this.filteredUsers.slice(start, end);
    },
    resetPage() {
        this.currentPage = 1;
    },
    openEdit(user) {
      this.selectedUser = JSON.parse(JSON.stringify(user));
      this.editModal = true;
    },
    openDelete(user) {
      this.selectedUser = user;
      this.deleteModal = true;
    },
    formatDate(dateString) {
      if (!dateString) return '';
      const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
      const date = new Date(dateString);
      const day = date.getUTCDate();
      const month = months[date.getUTCMonth()];
      const year = date.getUTCFullYear();
      return `${day} ${month} ${year}`;
    },
    handleSuccess(title, text) {
        this.modalTitle = title;
        this.modalText = text;
        this.showSuccessModal = true;
    },
    handleError(title, text) {
        this.modalTitle = title;
        this.modalText = text;
        this.showErrorModal = true;
    },
    resetAddUserForm() {
        this.newUser = { firstName: '', lastName: '', email: '', phone: '', role: 'Customer', avatar: '', dob: '', address: '', newPassword: '', avatarPreview: null };
    },
    async addUser() {
        try {
            if (!this.newUser.firstName || !this.newUser.lastName || !this.newUser.email || !this.newUser.newPassword) {
                this.handleError('Validation Error', 'First Name, Last Name, Email, and Password are required.');
                return;
            }

            // Handle avatar upload if there is one
            let avatarPath = null;
            if (this.newUser.avatarPreview) {
                const formData = new FormData();

                // Convert the blob URL to a file
                const response = await fetch(this.newUser.avatarPreview);
                const blob = await response.blob();
                formData.append('avatar', blob, 'avatar.jpg');

                // Upload the avatar
                const uploadResponse = await fetch('/auth/upload-avatar', {
                    method: 'POST',
                    body: formData
                });

                if (!uploadResponse.ok) {
                    throw new Error('Failed to upload avatar');
                }

                const uploadResult = await uploadResponse.json();
                avatarPath = uploadResult.avatarPath;
            }

            // Prepare user data for API
            const userData = {
                first_name: this.newUser.firstName,
                last_name: this.newUser.lastName,
                email: this.newUser.email,
                phone: this.newUser.phone,
                role: this.newUser.role,
                password: this.newUser.newPassword,
                dob: this.newUser.dob || null,
                address: this.newUser.address || null,
                avatar: avatarPath
            };

            // Send API request to create user
            const response = await fetch('/admin/api/users', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(userData)
            });

            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(errorData.message || 'Failed to create user');
            }

            // Refresh user list
            await this.fetchUsers();

            // Close modal and show success message
            this.showModal = false;
            this.handleSuccess('User Added', 'The new user has been added successfully.');
            this.resetAddUserForm();
        } catch (error) {
            console.error('Error adding user:', error);
            this.handleError('Error', error.message || 'Failed to add user');
        }
    },
    async updateUser() {
        try {
            if (!this.selectedUser.firstName || !this.selectedUser.lastName || !this.selectedUser.email) {
                this.handleError('Validation Error', 'First Name, Last Name, and Email are required.');
                return;
            }

            // Handle avatar upload if there is one
            let avatarPath = this.selectedUser.avatar;
            if (this.selectedUser.avatarPreview && !this.selectedUser.avatarPreview.startsWith('http')) {
                const formData = new FormData();

                // Convert the blob URL to a file
                const response = await fetch(this.selectedUser.avatarPreview);
                const blob = await response.blob();
                formData.append('avatar', blob, 'avatar.jpg');

                // Upload the avatar
                const uploadResponse = await fetch('/auth/upload-avatar', {
                    method: 'POST',
                    body: formData
                });

                if (!uploadResponse.ok) {
                    throw new Error('Failed to upload avatar');
                }

                const uploadResult = await uploadResponse.json();
                avatarPath = uploadResult.avatarPath;
            }

            // Prepare user data for API
            const userData = {
                first_name: this.selectedUser.firstName,
                last_name: this.selectedUser.lastName,
                email: this.selectedUser.email,
                phone: this.selectedUser.phone,
                role: this.selectedUser.role,
                dob: this.selectedUser.dob || null,
                address: this.selectedUser.address || null,
                avatar: avatarPath
            };

            // Add password only if a new one was provided
            if (this.selectedUser.newPassword) {
                userData.password = this.selectedUser.newPassword;
            }

            // Send API request to update user
            const response = await fetch(`/admin/api/users/${this.selectedUser.id}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(userData)
            });

            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(errorData.message || 'Failed to update user');
            }

            // Refresh user list
            await this.fetchUsers();

            // Close modal and show success message
            this.editModal = false;
            this.handleSuccess('User Updated', 'The user details have been updated successfully.');
        } catch (error) {
            console.error('Error updating user:', error);
            this.handleError('Error', error.message || 'Failed to update user');
        }
    },
    async deleteUser() {
        try {
            // Send API request to delete user
            const response = await fetch(`/admin/api/users/${this.selectedUser.id}`, {
                method: 'DELETE',
            });

            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(errorData.message || 'Failed to delete user');
            }

            // Refresh user list
            await this.fetchUsers();

            // Close modal and show success message
            this.deleteModal = false;
            this.handleSuccess('User Deleted', 'The user has been removed successfully.');
        } catch (error) {
            console.error('Error deleting user:', error);
            this.handleError('Error', error.message || 'Failed to delete user');
        }
    }
  }">
            <div class="col-span-12">
                <div class="flex items-center justify-between py-5 lg:py-6">
                    <div class="flex items-center space-x-1">
                        <h2 class="text-xl font-medium text-slate-700 line-clamp-1 dark:text-navy-50 lg:text-2xl">
                            Manage Users
                        </h2>
                    </div>

                    <div class="flex items-center space-x-2">
                        <button @click="showModal = true" class="btn bg-info/10 font-medium text-info hover:bg-info/20 focus:bg-info/20 active:bg-info/25 space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="size-4 h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v1m0 18v-1m-6.364-2.636l.707-.707m12.728 0l-.707-.707M4 12H3m18 0h-1m-2.636-6.364l-.707.707M6.343 6.343l.707-.707"></path>
                            </svg>
                            <span>Add User</span>
                        </button>
                        <label class="relative hidden sm:flex">
                            <input
                                    x-model="searchQuery" @input.debounce.300ms="resetPage()"
                                    class="form-input peer h-9 w-full rounded-full border border-slate-300 bg-transparent px-3 py-2 pl-9 text-xs+ placeholder:text-slate-400/70 hover:border-slate-400 focus:border-primary dark:border-navy-450 dark:hover:border-navy-400 dark:focus:border-accent"
                                    placeholder="Search users..."
                                    type="text"
                            >
                            <span
                                    class="pointer-events-none absolute flex h-full w-10 items-center justify-center text-slate-400 peer-focus:text-primary dark:text-navy-300 dark:peer-focus:text-accent"
                            >
    <svg
            xmlns="http://www.w3.org/2000/svg"
            class="size-4 transition-colors duration-200"
            fill="currentColor"
            viewbox="0 0 24 24"
    >
      <path
              d="M3.316 13.781l.73-.171-.73.171zm0-5.457l.73.171-.73-.171zm15.473 0l.73-.171-.73.171zm0 5.457l.73.171-.73.171zm-5.008 5.008l-.171-.73.171.73zm-5.457 0l-.171.73.171-.73zm0-15.473l-.171-.73.171.73zm5.457 0l.171-.73-.171.73zM20.47 21.53a.75.75 0 101.06-1.06l-1.06 1.06zM4.046 13.61a11.198 11.198 0 010-5.115l-1.46-.342a12.698 12.698 0 000 5.8l1.46-.343zm14.013-5.115a11.196 11.196 0 010 5.115l1.46.342a12.698 12.698 0 000-5.8l-1.46.343zm-4.45 9.564a11.196 11.196 0 01-5.114 0l-.342 1.46c1.907.448 3.892.448 5.8 0l-.343-1.46zM8.496 4.046a11.198 11.198 0 015.115 0l.342-1.46a12.698 12.698 0 00-5.8 0l.343 1.46zm0 14.013a5.97 5.97 0 01-4.45-4.45l-1.46.343a7.47 7.47 0 005.568 5.568l.342-1.46zm5.457 1.46a7.47 7.47 0 005.568-5.567l-1.46-.342a5.97 5.97 0 01-4.45 4.45l.342 1.46zM13.61 4.046a5.97 5.97 0 014.45 4.45l1.46-.343a7.47 7.47 0 00-5.568-5.567l-.342 1.46zm-5.457-1.46a7.47 7.47 0 00-5.567 5.567l1.46.342a5.97 5.97 0 014.45-4.45l-.343-1.46zm8.652 15.28l3.665 3.664 1.06-1.06-3.665-3.665-1.06 1.06z"
      />
    </svg>
  </span>
                        </label>
                    </div>
                </div>

                <!-- Add User Modal -->
                <template x-teleport="#x-teleport-target">
                    <div class="fixed inset-0 z-[100] flex flex-col items-center justify-center overflow-hidden px-4 py-6 sm:px-5"
                         x-data="{ isAddingUser: false }"
                         x-show="showModal" role="dialog" @keydown.window.escape="showModal = false">
                        <div class="absolute inset-0 bg-slate-900/60 transition-opacity duration-300" @click="showModal = false" x-show="showModal" x-transition:enter="ease-out" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="ease-in" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0"></div>
                        <div class="relative flex w-full max-w-lg flex-col rounded-lg bg-white transition-all duration-300 dark:bg-navy-700" style="max-height: 90vh;" x-show="showModal" x-transition:enter="easy-out" x-transition:enter-start="opacity-0 scale-95" x-transition:enter-end="opacity-100 scale-100" x-transition:leave="easy-in" x-transition:leave-start="opacity-100 scale-100" x-transition:leave-end="opacity-0 scale-95">
                            <div class="flex-shrink-0 rounded-t-lg bg-slate-200 px-4 py-3 dark:bg-navy-800 sm:px-5 flex justify-between items-center">
                                <h3 class="text-base font-medium text-slate-700 dark:text-navy-100">Add New User</h3>
                                <button @click="showModal = !showModal" class="btn -mr-1.5 size-7 rounded-full p-0 hover:bg-slate-300/20 focus:bg-slate-300/20 active:bg-slate-300/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="size-4.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg>
                                </button>
                            </div>
                            <div class="flex-grow overflow-y-auto px-4 py-4 sm:px-5">
                                <div class="space-y-4">
                                    <div class="flex flex-col items-center space-y-4">
                                        <div class="avatar size-20">
                                            <template x-if="!newUser.avatarPreview"><div class="mask is-squircle bg-slate-200 dark:bg-navy-500 flex items-center justify-center"><svg class="size-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 11C14.2091 11 16 9.20914 16 7C16 4.79086 14.2091 3 12 3C9.79086 3 8 4.79086 8 7C8 9.20914 9.79086 11 12 11Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M6.00016 19C6.00016 16.2386 8.68646 14 12.0002 14C15.3139 14 18.0002 16.2386 18.0002 19" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></div></template>
                                            <template x-if="newUser.avatarPreview"><img class="mask is-squircle" :src="newUser.avatarPreview" alt="avatar"/></template>
                                        </div>
                                        <label class="btn bg-info/10 font-medium text-info hover:bg-info/20 focus:bg-info/20 active:bg-info/25 relative">
                                            <input tabindex="-1" type="file" @change="newUser.avatarPreview = URL.createObjectURL($event.target.files[0])" class="pointer-events-none absolute inset-0 h-full w-full opacity-0"/>
                                            <div class="flex items-center space-x-2"><i class="fa-solid fa-cloud-arrow-up text-base"></i><span>Upload Avatar</span></div>
                                        </label>
                                    </div>
                                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                        <label class="block"><span>First Name:</span><input x-model="newUser.firstName" class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2 placeholder:text-slate-400/70 hover:border-slate-400 focus:border-primary dark:border-navy-450 dark:hover:border-navy-400 dark:focus:border-accent" placeholder="First Name" type="text" /></label>
                                        <label class="block"><span>Last Name:</span><input x-model="newUser.lastName" class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2 placeholder:text-slate-400/70 hover:border-slate-400 focus:border-primary dark:border-navy-450 dark:hover	border-navy-400 dark:focus:border-accent" placeholder="Last Name" type="text" /></label>
                                    </div>
                                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                        <label class="block"><span>Email Address:</span><input x-model="newUser.email" class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2 placeholder:text-slate-400/70 hover:border-slate-400 focus:border-primary dark:border-navy-450 dark:hover:border-navy-400 dark:focus:border-accent" placeholder="Email Address" type="email" /></label>
                                        <label class="block"><span>Phone Number:</span><input x-model="newUser.phone" class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2 placeholder:text-slate-400/70 hover:border-slate-400 focus:border-primary dark:border-navy-450 dark:hover:border-navy-400 dark:focus:border-accent" placeholder="Phone Number" type="text" /></label>
                                    </div>
                                    <label class="block"><span>Address:</span><input x-model="newUser.address" class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2 placeholder:text-slate-400/70 hover:border-slate-400 focus:border-primary dark:border-navy-450 dark:hover:border-navy-400 dark:focus:border-accent" placeholder="City, Suburb" type="text" /></label>
                                    <label class="block"><span>Date of Birth:</span><input x-model="newUser.dob" class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2 placeholder:text-slate-400/70 hover:border-slate-400 focus:border-primary dark:border-navy-450 dark:hover:border-navy-400 dark:focus:border-accent" type="date" /></label>
                                    <label class="block"><span>Password:</span><input x-model="newUser.newPassword" class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2 placeholder:text-slate-400/70 hover:border-slate-400 focus:border-primary dark:border-navy-450 dark:hover:border-navy-400 dark:focus:border-accent" placeholder="Password" type="password" /></label>
                                    <label class="block"><span>User Type:</span><select x-model="newUser.role" class="form-select mt-1.5 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 hover:border-slate-400 focus:border-primary dark:border-navy-450 dark:bg-navy-700 dark:hover:border-navy-400 dark:focus:border-accent"><option>Admin</option><option>Manager</option><option>Customer</option></select></label>
                                </div>
                            </div>
                            <div class="flex-shrink-0 space-x-2 text-right p-4 sm:p-5 border-t border-slate-100 dark:border-navy-600">
                                <button @click="showModal = false" class="btn bg-warning/10 font-medium text-warning hover:bg-warning/20 focus:bg-warning/20 active:bg-warning/25">Cancel</button>
                                <button
                                        @click="
                                        isAddingUser = true;
                                        Promise.resolve(addUser()).finally(() => isAddingUser = false);
                                    "
                                        :disabled="isAddingUser"
                                        class="btn bg-info/10 font-medium text-info hover:bg-info/20 focus:bg-info/20 active:bg-info/25 relative"
                                >
                                    <span x-show="!isAddingUser">Add User</span>
                                    <span x-show="isAddingUser">Adding...</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </template>

                <!-- User Table -->
                <div class="card mt-3">
                    <div class="is-scrollbar-hidden min-w-full overflow-x-auto">
                        <!-- Loading spinner -->
                        <div x-show="isLoading" class="flex justify-center items-center p-8">
                            <div class="animate-spin size-12 rounded-full border-4 border-primary/30 border-t-primary"></div>
                        </div>

                        <!-- Empty state -->
                        <div x-show="!isLoading && users.length === 0" class="p-8 text-center">
                            <p class="text-slate-400 dark:text-navy-300">No users found. Add your first user by clicking &quot;Add User&quot; button.</p>
                        </div>

                        <table x-show="!isLoading && users.length > 0" class="is-hoverable w-full text-left">
                            <thead>
                            <tr>
                                <th class="whitespace-nowrap rounded-tl-lg bg-slate-200 px-4 py-3 font-semibold uppercase text-slate-800 dark:bg-navy-800 dark:text-navy-100 lg:px-5">User</th>
                                <th class="whitespace-nowrap bg-slate-200 px-4 py-3 font-semibold uppercase text-slate-800 dark:bg-navy-800 dark:text-navy-100 lg:px-5">Phone Number</th>
                                <th class="whitespace-nowrap bg-slate-200 px-4 py-3 font-semibold uppercase text-slate-800 dark:bg-navy-800 dark:text-navy-100 lg:px-5">Address</th>
                                <th class="whitespace-nowrap bg-slate-200 px-4 py-3 font-semibold uppercase text-slate-800 dark:bg-navy-800 dark:text-navy-100 lg:px-5">Date of Birth</th>
                                <th class="whitespace-nowrap bg-slate-200 px-4 py-3 font-semibold uppercase text-slate-800 dark:bg-navy-800 dark:text-navy-100 lg:px-5">Joined Date</th>
                                <th class="whitespace-nowrap bg-slate-200 px-4 py-3 font-semibold uppercase text-slate-800 dark:bg-navy-800 dark:text-navy-100 lg:px-5">User Role</th>
                                <th class="whitespace-nowrap rounded-tr-lg bg-slate-200 px-4 py-3 font-semibold uppercase text-slate-800 dark:bg-navy-800 dark:text-navy-100 lg:px-5">Action</th>
                            </tr>
                            </thead>
                            <tbody>
                            <template x-for="user in paginatedUsers" :key="user.id">
                                <tr class="border-y border-transparent border-b-slate-200 dark:border-b-navy-500">
                                    <td class="whitespace-nowrap px-4 py-3 sm:px-5">
                                        <div class="flex items-center space-x-4">
                                            <div class="avatar size-9">
                                                <img class="mask is-squircle" :src="user.avatar" alt="avatar">
                                            </div>
                                            <div class="flex flex-col">
                                                <span class="font-medium text-slate-700 dark:text-navy-100" x-text="user.firstName + ' ' + user.lastName"></span>
                                                <span class="text-xs text-slate-500 dark:text-navy-300" x-text="user.email"></span>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="whitespace-nowrap px-4 py-3 sm:px-5" x-text="user.phone"></td>
                                    <td class="whitespace-nowrap px-4 py-3 sm:px-5" x-text="user.address"></td>
                                    <td class="whitespace-nowrap px-4 py-3 sm:px-5" x-text="formatDate(user.dob)"></td>
                                    <td class="whitespace-nowrap px-4 py-3 sm:px-5" x-text="user.dateAdded"></td>
                                    <td class="whitespace-nowrap px-4 py-3 sm:px-5">
                                        <div class="badge" :class="{
                          'bg-success/10 text-success dark:bg-success/15': user.role === 'manager',
                          'bg-warning/10 text-warning dark:bg-warning/15': user.role === 'customer',
                          'bg-error/10 text-error dark:bg-error/15': user.role === 'admin'
                       }" x-text="user.role">
                                        </div>
                                    </td>
                                    <td class="whitespace-nowrap px-4 py-3 sm:px-5">
                                        <div class="flex space-x-2">
                                            <button @click="openEdit(user)" class="btn border border-primary/30 bg-primary/10 font-medium text-primary hover:bg-primary/20 focus:bg-primary/20 active:bg-primary/25 dark:border-accent-light/30 dark:bg-accent-light/10 dark:text-accent-light dark:hover:bg-accent-light/20 dark:focus:bg-accent-light/20 dark:active:bg-accent-light/25">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button @click="openDelete(user)" class="btn border border-error/30 bg-error/10 font-medium text-error hover:bg-error/20 focus:bg-error/20 active:bg-error/25">
                                                <i class="fas fa-trash-alt"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </template>
                            </tbody>
                        </table>
                    </div>

                    <div class="flex flex-col justify-between space-y-4 px-4 py-4 sm:flex-row sm:items-center sm:space-y-0 sm:px-5">
                        <div class="flex items-center space-x-2 text-xs+">
                            <span>Show</span>
                            <label class="block">
                                <select x-model="entriesPerPage" @change="resetPage()" class="form-select rounded-full border border-slate-300 bg-white px-2 py-1 pr-6 hover:border-slate-400 focus:border-primary dark:border-navy-450 dark:bg-navy-700 dark:hover:border-navy-400 dark:focus:border-accent">
                                    <option>10</option>
                                    <option>30</option>
                                    <option>50</option>
                                </select>
                            </label>
                            <span>entries</span>
                        </div>

                        <ol class="pagination">
                            <li class="rounded-l-lg bg-slate-150 dark:bg-navy-500">
                                <button @click="if (currentPage > 1) currentPage--" class="flex size-8 items-center justify-center rounded-lg text-slate-500 transition-colors hover:bg-slate-300 focus:bg-slate-300 active:bg-slate-300/80 dark:text-navy-200 dark:hover:bg-navy-450 dark:focus:bg-navy-450 dark:active:bg-navy-450/90" :class="{'pointer-events-none opacity-50': currentPage === 1}">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="size-4" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg>
                                </button>
                            </li>
                            <template x-for="page in Array.from({ length: totalPages }, (_, i) => i + 1)">
                                <li class="bg-slate-150 dark:bg-navy-500">
                                    <button @click="currentPage = page" class="flex h-8 min-w-[2rem] items-center justify-center rounded-lg px-3 leading-tight transition-colors" :class="currentPage === page ? 'bg-primary text-white dark:bg-accent' : 'hover:bg-slate-300 dark:hover:bg-navy-450'">
                                        <span x-text="page"></span>
                                    </button>
                                </li>
                            </template>
                            <li class="rounded-r-lg bg-slate-150 dark:bg-navy-500">
                                <button @click="if (currentPage < totalPages) currentPage++" class="flex size-8 items-center justify-center rounded-lg text-slate-500 transition-colors hover:bg-slate-300 focus:bg-slate-300 active:bg-slate-300/80 dark:text-navy-200 dark:hover:bg-navy-450 dark:focus:bg-navy-450 dark:active:bg-navy-450/90" :class="{'pointer-events-none opacity-50': currentPage === totalPages}">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="size-4" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                                </button>
                            </li>
                        </ol>

                        <div class="text-xs+">
                            Showing <span x-text="Math.min((currentPage - 1) * entriesPerPage + 1, filteredUsers.length)"></span>
                            to <span x-text="Math.min(currentPage * entriesPerPage, filteredUsers.length)"></span>
                            of <span x-text="filteredUsers.length"></span> entries
                        </div>
                    </div>
                </div>

                <!-- Edit Modal -->
                <template x-teleport="#x-teleport-target">
                    <div class="fixed inset-0 z-[100] flex flex-col items-center justify-center overflow-hidden px-4 py-6 sm:px-5"
                         x-data="{ isUpdatingUser: false }"
                         x-show="editModal" role="dialog" @keydown.window.escape="editModal = false">
                        <div class="absolute inset-0 bg-slate-900/60 transition-opacity duration-300" @click="editModal = false" x-show="editModal" x-transition:enter="ease-out" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="ease-in" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0"></div>
                        <div class="relative flex w-full max-w-lg flex-col rounded-lg bg-white transition-all duration-300 dark:bg-navy-700" style="max-height: 90vh;" x-show="editModal" x-transition:enter="easy-out" x-transition:enter-start="opacity-0 scale-95" x-transition:enter-end="opacity-100 scale-100" x-transition:leave="easy-in" x-transition:leave-start="opacity-100 scale-100" x-transition:leave-end="opacity-0 scale-95">
                            <div class="flex-shrink-0 flex justify-between rounded-t-lg bg-slate-200 px-4 py-3 dark:bg-navy-800 sm:px-5">
                                <h3 class="text-base font-medium text-slate-700 dark:text-navy-100">Edit User</h3>
                                <button @click="editModal = false" class="btn -mr-1.5 size-7 rounded-full p-0 hover:bg-slate-300/20 focus:bg-slate-300/20 active:bg-slate-300/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="size-4.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg>
                                </button>
                            </div>
                            <div class="flex-grow overflow-y-auto px-4 py-4 sm:px-5">
                                <div class="space-y-4">
                                    <div class="flex flex-col items-center space-y-4">
                                        <div class="avatar size-20">
                                            <img class="mask is-squircle" :src="selectedUser.avatarPreview || selectedUser.avatar" alt="avatar" />
                                        </div>
                                        <label class="btn bg-info/10 font-medium text-info hover:bg-info/20 focus:bg-info/20 active:bg-info/25 relative">
                                            <input tabindex="-1" type="file" @change="selectedUser.avatarPreview = URL.createObjectURL($event.target.files[0])" class="pointer-events-none absolute inset-0 h-full w-full opacity-0" />
                                            <div class="flex items-center space-x-2"><i class="fa-solid fa-cloud-arrow-up text-base"></i><span>Change Avatar</span></div>
                                        </label>
                                    </div>
                                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                        <label class="block"><span>First Name:</span><input x-model="selectedUser.firstName" class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2" type="text" /></label>
                                        <label class="block"><span>Last Name:</span><input x-model="selectedUser.lastName" class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2" type="text" /></label>
                                    </div>
                                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                        <label class="block"><span>Email Address:</span><input x-model="selectedUser.email" class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2" type="email" /></label>
                                        <label class="block"><span>Phone Number:</span><input x-model="selectedUser.phone" class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2" type="text" /></label>
                                    </div>
                                    <label class="block"><span>Address:</span><input x-model="selectedUser.address" class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2" placeholder="City, Suburb" type="text" /></label>
                                    <label class="block"><span>Date of Birth:</span><input x-model="selectedUser.dob" class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2" type="date" /></label>
                                    <label class="block"><span>New Password (optional):</span><input x-model="selectedUser.newPassword" class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2" placeholder="Enter new password" type="password" /></label>
                                    <label class="block"><span>User Role:</span><select x-model="selectedUser.role" class="form-select mt-1.5 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 dark:border-navy-450 dark:bg-navy-700"><option>Current Role</option><option>Customer</option><option>Manager</option><option>Admin</option></select></label>
                                </div>
                            </div>
                            <div class="flex-shrink-0 space-x-2 text-right p-4 sm:p-5 border-t border-slate-100 dark:border-navy-600">
                                <button @click="editModal = false" class="btn bg-warning/10 font-medium text-warning hover:bg-warning/20 focus:bg-warning/20 active:bg-warning/25">Cancel</button>
                                <button
                                        @click="
                                        isUpdatingUser = true;
                                        Promise.resolve(updateUser()).finally(() => isUpdatingUser = false);
                                    "
                                        :disabled="isUpdatingUser"
                                        class="btn bg-info/10 font-medium text-info hover:bg-info/20 focus:bg-info/20 active:bg-info/25 relative"
                                >
                                    <span x-show="!isUpdatingUser">Save Changes</span>
                                    <span x-show="isUpdatingUser">Saving...</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </template>

                <!-- Delete Modal -->
                <template x-teleport="#x-teleport-target">
                    <div class="fixed inset-0 z-[100] flex flex-col items-center justify-center overflow-hidden px-4 py-6 sm:px-5"
                         x-data="{ isDeletingUser: false }"
                         x-show="deleteModal" role="dialog" @keydown.window.escape="deleteModal = false">
                        <div class="absolute inset-0 bg-slate-900/60 transition-opacity duration-300" @click="deleteModal = false" x-show="deleteModal" x-transition:enter="ease-out" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="ease-in" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0"></div>
                        <div class="relative max-w-md rounded-lg bg-white pt-10 pb-4 text-center transition-all duration-300 dark:bg-navy-700" x-show="deleteModal" x-transition:enter="easy-out" x-transition:enter-start="opacity-0 [transform:translate3d(0,1rem,0)]" x-transition:enter-end="opacity-100 [transform:translate3d(0,0,0)]" x-transition:leave="easy-in" x-transition:leave-start="opacity-100 [transform:translate3d(0,0,0)]" x-transition:leave-end="opacity-0 [transform:translate3d(0,1rem,0)]">
                            <div class="avatar size-20">
                                <img class="rounded-full" :src="selectedUser.avatar" alt="avatar" />
                            </div>
                            <div class="mt-4 px-4 sm:px-12">
                                <h3 class="text-lg font-medium text-slate-800 dark:text-navy-50" x-text="selectedUser.firstName + ' ' + selectedUser.lastName"></h3>
                                <p class="mt-1 text-slate-500 dark:text-navy-200">Are you sure you want to delete this user?</p>
                            </div>
                            <div class="my-4 mt-16 h-px bg-slate-200 dark:bg-navy-500"></div>
                            <div class="space-x-3">
                                <button @click="deleteModal = false" class="btn bg-warning/10 font-medium text-warning hover:bg-warning/20 focus:bg-warning/20 active:bg-warning/25">Cancel</button>
                                <button
                                        @click="
                                        isDeletingUser = true;
                                        Promise.resolve(deleteUser()).finally(() => isDeletingUser = false);
                                    "
                                        :disabled="isDeletingUser"
                                        class="btn bg-error/10 font-medium text-error hover:bg-error/20 focus:bg-error/20 active:bg-error/25"
                                >
                                    <span x-show="!isDeletingUser">Delete</span>
                                    <span x-show="isDeletingUser">Deleting...</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </template>

                <!-- Success Modal -->
                <template x-teleport="#x-teleport-target">
                    <div class="fixed inset-0 z-[100] flex flex-col items-center justify-center overflow-hidden px-4 py-6 sm:px-5" x-show="showSuccessModal" role="dialog" @keydown.window.escape="showSuccessModal = false">
                        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur transition-opacity duration-300" @click="showSuccessModal = false" x-show="showSuccessModal" x-transition:enter="ease-out" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="ease-in" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0"></div>
                        <div class="relative max-w-lg rounded-lg bg-white px-4 py-10 text-center transition-opacity duration-300 dark:bg-navy-700 sm:px-5" x-show="showSuccessModal" x-transition:enter="ease-out" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="ease-in" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="inline size-28 text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <div class="mt-4">
                                <h2 class="text-2xl text-slate-700 dark:text-navy-100" x-text="modalTitle"></h2>
                                <p class="mt-2" x-text="modalText"></p>
                                <button @click="showSuccessModal = false" class="btn mt-6 bg-success/10 font-medium text-success hover:bg-success/20 focus:bg-success/20 active:bg-success/25">Close</button>
                            </div>
                        </div>
                    </div>
                </template>

                <!-- Error Modal -->
                <template x-teleport="#x-teleport-target">
                    <div class="fixed inset-0 z-[100] flex flex-col items-center justify-center overflow-hidden px-4 py-6 sm:px-5" x-show="showErrorModal" role="dialog" @keydown.window.escape="showErrorModal = false">
                        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur transition-opacity duration-300" @click="showErrorModal = false" x-show="showErrorModal" x-transition:enter="ease-out" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="ease-in" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0"></div>
                        <div class="relative max-w-lg rounded-lg bg-white px-4 py-10 text-center transition-opacity duration-300 dark:bg-navy-700 sm:px-5" x-show="showErrorModal" x-transition:enter="ease-out" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="ease-in" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="inline size-28 text-error" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                            <div class="mt-4">
                                <h2 class="text-2xl text-slate-700 dark:text-navy-100" x-text="modalTitle"></h2>
                                <p class="mt-2" x-text="modalText"></p>
                                <button @click="showErrorModal = false" class="btn mt-6 bg-error/10 font-medium text-error hover:bg-error/20 focus:bg-error/20 active:bg-error/25">Close</button>
                            </div>
                        </div>
                    </div>
                </template>

            </div>
        </div>
    </main>

</div>


<div id="x-teleport-target"></div>
<script>
  window.addEventListener("DOMContentLoaded", () => Alpine.start());
</script>

</body>
</html>